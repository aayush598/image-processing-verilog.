# Image Processing Pipeline

This project provides a simple pipeline to convert an image to hex values, (optionally) process those values, and convert the hex values back to an image.

## Files

* `image_to_hex.py`: Converts an image to a text file containing hexadecimal representations of the pixel values.
* `hex_to_image.py`: Converts a text file of hexadecimal pixel values back to an image.
* `run_all.py`: A script to run the entire pipeline, including an example of Verilog-based image processing (commented out).
* `image.jpg`: A sample input image.
* `image_hex.txt`: A sample output hex file (generated by `image_to_hex.py`).
* `output_hex.txt`: A sample output hex file (potentially modified/processed).
* `processed_image.jpg`: A sample output image (generated by `hex_to_image.py`).
* `image_processor.v`: A Verilog file (example - not used by default).
* Other files: Potentially other intermediate files generated during processing.

## Requirements

* Python 3.x
* OpenCV (`cv2`) - Install using `pip install opencv-python`
* `numpy` - Install using `pip install numpy`
* (Optional, for Verilog processing):
    * `iverilog`
    * `vvp`

## Setup

1.  **Install Python Dependencies:**

    ```bash
    pip install opencv-python numpy
    ```

2.  **Ensure you have an input image:**

    * The scripts default to using `image.jpg`. You can replace this with your own image, but make sure to update the filenames in the scripts accordingly.

3.  **(Optional) Install Verilog tools:**

    * If you intend to use the `image_processor.v` (or similar Verilog code), make sure you have `iverilog` and `vvp` installed on your system. These are command-line tools for compiling and running Verilog simulations.

## Usage

### 1. Convert Image to Hex

```bash
python image_to_hex.py
```
This will:

- Read image.jpg.
- Resize it to 512x512 (by default, can be changed in the script).
- Convert it to grayscale.
- Save the hex representation of the pixel values to image_hex.txt.

### 2. (Optional) Process the Hex Values
This is where you would insert your image processing logic. The provided run_all.py script includes an example of running a Verilog simulation (image_processor.v), but this is commented out.

Example (Verilog - requires iverilog):

You would need to write your image processing algorithm in Verilog (like the provided image_processor.v or your own).

Compile the Verilog code:

```bash
iverilog -o image_processor image_processor.v
```

Run the simulation:

```bash
vvp image_processor
```

The Verilog simulation would need to output a file named output_hex.txt containing the processed hex values.

Alternative (Python):

You could also process the image_hex.txt file directly using Python. For example, you could write a Python script to:

- Read image_hex.txt.
- Perform operations on the pixel values.
- Write the modified hex values to a new file named output_hex.txt.

### 3. Convert Hex Back to Image
```bash
python hex_to_image.py
```
This will:

Read hex values from output_hex.txt.
Create a grayscale image from those values.
Save the image as processed_image.jpg.

### 4. Run the Entire Pipeline
The run_all.py script automates the process:

```bash
python run_all.py
```
This script will:

- Convert image.jpg to image_hex.txt.
(Optionally, if you uncomment the Verilog code) 
- Compile and run the Verilog simulation.
- Convert output_hex.txt to processed_image.jpg.


## 5. Image Processing IP Flow (Hardware Design and Visualization)

The `run_all_ip.py` script extends the main pipeline by integrating Verilog simulation and RTL visualization into a single automated flow. It is ideal if you're working on custom hardware designs for image processing and want to visualize your synthesized design.

Run it using:

```bash
python run_all_ip.py
```

This script will:

1. Convert `image3.jpg` to `image_hex.txt`.
2. Simulate your custom image processing logic in `image_processor_ip.v` using `iverilog` and `vvp`.
3. Convert the processed hex values in `output_hex.txt` back to a grayscale image (`processed_image.jpg`).
4. Synthesize the Verilog code using **Yosys** (`synth.ys` must be present).
5. Generate an RTL diagram in SVG format using **netlistsvg**.
6. Convert the SVG to a PDF using **rsvg-convert** for easy sharing and documentation.

### Output Files:

- `processed_image.jpg`: The final image after simulation.
- `image_processor.svg`: SVG RTL schematic.
- `image_processor.pdf`: PDF version of RTL schematic for reports.

### Additional Tools Required:

Install the following if not already installed:

```bash
# For synthesis
sudo apt install yosys

# For RTL visualization
npm install -g netlistsvg

# For converting SVG to PDF
sudo apt install librsvg2-bin
```

Make sure you also have a `synth.ys` file like:

```yosys
read_verilog image_processor_ip.v
synth -top image_processor_ip
write_json image_processor.json
```

### Notes
Image Size: The scripts default to resizing images to 512x512. You can change this by modifying the resize_dimensions parameter in image_to_hex.py and the width and height parameters in hex_to_image.py. Make sure these dimensions match!
<br>Grayscale: The scripts currently work with grayscale images. You would need to modify them to handle color images.
<br>Error Handling: The scripts include basic error handling, but you may want to add more robust error checking for production use.
<br>Verilog Processing: The Verilog example is a placeholder. You'll need to provide your own Verilog code for actual image processing. The interface between the Python scripts and the Verilog code (using text files for hex values) is a simple way to integrate hardware-based processing into a Python workflow.